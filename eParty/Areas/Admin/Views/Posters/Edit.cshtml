@model eParty.Models.Poster

@{
    ViewBag.Title = "Edit Poster";
    Layout = "~/Areas/Admin/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="page-header">
    <h3 class="fw-bold mb-3">Poster Management</h3>
    <ul class="breadcrumbs mb-3">
        <li class="nav-home"><a href="@Url.Action("Index", "Dashboard")"><i class="icon-home"></i></a></li>
        <li class="separator"><i class="icon-arrow-right"></i></li>
        <li class="nav-item"><a href="@Url.Action("Index", "Posters")">Posters</a></li>
        <li class="separator"><i class="icon-arrow-right"></i></li>
        <li class="nav-item"><a href="#">Edit</a></li>
    </ul>
</div>

<div class="row">
    <div class="col-md-12">
        @using (Html.BeginForm("Edit", "Posters", FormMethod.Post, new { enctype = "multipart/form-data" }))
        {
            @Html.AntiForgeryToken()
            @Html.HiddenFor(model => model.Id)
            <div class="card">
                <div class="card-header"><div class="card-title">Edit Poster: @Model.Name</div></div>
                <div class="card-body">
                    @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="form-group">
                                @Html.LabelFor(model => model.Name, new { @class = "form-label" })
                                @Html.EditorFor(model => model.Name, new { htmlAttributes = new { @class = "form-control", placeholder = "Enter poster name" } })
                                @Html.ValidationMessageFor(model => model.Name, "", new { @class = "text-danger" })
                            </div>
                        </div>

                        <div class="col-md-6 mb-3">
                            <div class="form-group">
                                <label>Current Image</label><br />
                                @if (!string.IsNullOrEmpty(Model.Image))
                                {
                                    <img id="currentImage" src="data:image/jpeg;base64,@Model.Image" alt="@Model.Name" style="max-width:200px; display:block; margin-bottom:10px;" />
                                }
                                else
                                {
                                    <img id="currentImage" src="@Url.Content("~/images/no-image.png")" alt="No Image" style="max-width:200px; display:block; margin-bottom:10px;" />
                                }

                                <label for="imageFile">Upload New Image</label>
                                <input type="file" id="imageFile" name="imageFile" class="form-control" />
                                <img id="previewImage" src="#" alt="Preview" style="max-width:200px; display:none; margin-top:10px;" />
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-action">
                    <button type="submit" class="btn btn-success"><i class="fa fa-save"></i> Save</button>
                    <a href="@Url.Action("Index")" class="btn btn-secondary"><i class="fa fa-arrow-left"></i> Back to List</a>
                </div>
            </div>
        }
    </div>
</div>

@section scripts {
    <script>
        document.getElementById('imageFile').addEventListener('change', function(e){
            var reader = new FileReader();
            reader.onload = function(e){
                var img = document.getElementById('previewImage');
                img.src = e.target.result;
                img.style.display = 'block';
            };
            reader.readAsDataURL(this.files[0]);
        });
    </script>
    @Scripts.Render("~/bundles/jqueryval")
}
